(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{19:function(e,t,a){e.exports=a(33)},31:function(e,t,a){},33:function(e,t,a){"use strict";a.r(t);var n=a(0),l=a.n(n),r=a(15),o=a.n(r),c=a(3),i=a(4),s=a(7),u=a(6),h=a(8),m=a(35),d=a(36),p=a(34),g=a(11),b=a.n(g),E=a(17),f=a(13),v=a.n(f),y=function(){function e(t){Object(c.a)(this,e),this.domain="https://apptd.herokuapp.com",this.fetch=this.fetch.bind(this),this.login=this.login.bind(this),this.getProfile=this.getProfile.bind(this)}return Object(i.a)(e,[{key:"login",value:function(e,t){var a=this;return this.fetch("".concat(this.domain,"/auth/signin"),{method:"POST",body:JSON.stringify({email:e,password:t})}).then(function(e){return a.setToken(e.token),Promise.resolve(e)})}},{key:"loggedIn",value:function(){var e=this.getToken();return console.log(!!e&&!this.isTokenExpired(e)),!!e&&!this.isTokenExpired(e)}},{key:"isTokenExpired",value:function(e){try{return v()(e).exp<Date.now()/1e3}catch(t){return!1}}},{key:"setToken",value:function(e){localStorage.setItem("id_token",e)}},{key:"getToken",value:function(){return localStorage.getItem("id_token")}},{key:"logout",value:function(){localStorage.removeItem("id_token")}},{key:"getProfile",value:function(){return v()(this.getToken())}},{key:"fetch",value:function(e){function t(t,a){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}(function(e,t){console.log(e),console.log(t);var a={Accept:"application/json","Content-Type":"application/json"};return this.loggedIn()&&(a.Authorization="Bearer "+this.getToken()),fetch(e,Object(E.a)({headers:a},t)).then(this._checkStatus).then(function(e){return e.json()})})},{key:"_checkStatus",value:function(e){if(e.status>=200&&e.status<300)return e;var t=new Error(e.statusText);throw t.response=e,t}}]),e}(),C=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(s.a)(this,Object(u.a)(t).call(this,e))).state={products:[{}],show:!1,currentProduct:{}},a.Auth=new y,a}return Object(h.a)(t,e),Object(i.a)(t,[{key:"_show",value:function(e,t){this.Auth.loggedIn()?(this.setState({show:!0,currentProduct:e.products2}),console.log(e.products2)):(alert("Favor de iniciar sesi\xf3n con tu usuario"),this.props.history.replace("/signin"))}},{key:"close",value:function(){this.setState({show:!1})}},{key:"handleDownload",value:function(){var e=this,t=new XMLHttpRequest;t.open("GET","".concat("https://apptd.herokuapp.com","/items")),t.onreadystatechange=function(){if(4===t.readyState)if(200===t.status){var a=JSON.parse(t.responseText);console.log(a),e.setState({products:a})}else alert("No se pudieron descargar las im\xe1genes")},t.send()}},{key:"rentItem",value:function(){var e=this,t=new XMLHttpRequest;t.open("POST","".concat("https://apptd.herokuapp.com","/rents")),t.setRequestHeader("Content-type","application/x-www-form-urlencoded"),t.setRequestHeader("Authorization","Bearer "+this.Auth.getToken()),t.onreadystatechange=function(){4===t.readyState&&(201===t.status?(alert("Se va a redireccionar a PayPal para continuar con el pago."),e.close(),e.payment()):alert("No se pudo rentar el vestido."))},t.send("idItem=".concat(this.state.currentProduct._id))}},{key:"payment",value:function(){var e=this,t=new XMLHttpRequest;t.open("POST","".concat("https://apptd.herokuapp.com","/confirmorder")),t.setRequestHeader("Content-type","application/x-www-form-urlencoded"),t.setRequestHeader("Authorization","Bearer "+this.Auth.getToken()),t.onreadystatechange=function(){if(4===t.readyState)if(201===t.status){var a=JSON.parse(t.responseText);console.log(a),e.close(),window.location=a}else alert("No se pudo rentar el vestido.")},t.send()}},{key:"render",value:function(){var e=this,t=this.state.products.map(function(t){return l.a.createElement("div",{className:""},l.a.createElement("h1",null," Nombre: ",t.garmentName," "),"  ",l.a.createElement("br",null),l.a.createElement("h2",null," Precio: ",t.price," ")," ",l.a.createElement("br",null),l.a.createElement("h2",null," Color: ",t.color," ")," ",l.a.createElement("br",null),l.a.createElement("h2",null," Talla: ",t.size," ")," ",l.a.createElement("button",{onClick:e._show.bind(e,{products2:t})}," Lo rento!! ")," ",l.a.createElement("br",null),l.a.createElement("img",{src:t.url,alt:""}))});return l.a.createElement("div",null,l.a.createElement(b.a,{show:this.state.show,onClose:this.close.bind(this),transitionSpeed:600},l.a.createElement("a",{style:g.closeStyle,onClick:this.close.bind(this)}," X "),l.a.createElement("div",null," Ll\xe9vatelo por ",this.state.currentProduct.price," ")," ",l.a.createElement("div",null,l.a.createElement("button",{onClick:this.rentItem.bind(this)}," Me lo llevo!! ")," ",l.a.createElement("br",null),l.a.createElement("h1",null," Nombre: ",this.state.currentProduct.garmentName," "),"  ",l.a.createElement("br",null),l.a.createElement("h2",null," Precio: ",this.state.currentProduct.price," ")," ",l.a.createElement("br",null),l.a.createElement("h2",null," Color: ",this.state.currentProduct.color," ")," ",l.a.createElement("br",null),l.a.createElement("h2",null," Talla: ",this.state.currentProduct.size," ")," ",l.a.createElement("br",null),l.a.createElement("img",{src:this.state.currentProduct.url,alt:""}))," "),l.a.createElement("h2",null," Bienvenido ")," ",l.a.createElement("p",null," \xa1Saca tu vestido del closet, contribuye al mundo con la reutilizaci\xf3n!, The Dresser te ayudar\xe1. ")," ",l.a.createElement("p",null," Gana dinero sin salir de tu casa ")," ",l.a.createElement("p",null," \xa1Luce siempre diferente! ")," ",l.a.createElement("div",null," ",t," "))}},{key:"componentWillMount",value:function(){this.handleDownload()}}]),t}(n.Component),k=a(2),O=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(s.a)(this,Object(u.a)(t).call(this,e))).state={contactEmail:"",contactPass:"",contactName:"",contactLastName:""},a._handleSubmit=a._handleSubmit.bind(Object(k.a)(Object(k.a)(a))),a._handleChange=a._handleChange.bind(Object(k.a)(Object(k.a)(a))),a._handleChangePass=a._handleChangePass.bind(Object(k.a)(Object(k.a)(a))),a._handleChangeName=a._handleChangeName.bind(Object(k.a)(Object(k.a)(a))),a._handleChangeLastName=a._handleChangeLastName.bind(Object(k.a)(Object(k.a)(a))),a}return Object(h.a)(t,e),Object(i.a)(t,[{key:"_handleChange",value:function(e){this.setState({contactEmail:e.target.value})}},{key:"_handleChangePass",value:function(e){this.setState({contactPass:e.target.value})}},{key:"_handleChangeName",value:function(e){this.setState({contactName:e.target.value})}},{key:"_handleChangeLastName",value:function(e){this.setState({contactLastName:e.target.value})}},{key:"_handleSubmit",value:function(e){var t=this;e.preventDefault(),this.setState({contactEmail:"",contactPass:"",contactName:"",contactLastName:""});var a=new XMLHttpRequest;a.open("POST","".concat("https://apptd.herokuapp.com","/auth/signup")),a.setRequestHeader("Content-type","application/x-www-form-urlencoded"),a.onreadystatechange=function(){if(4===a.readyState)if(201===a.status){var e=JSON.parse(a.responseText);console.log(e),t.setState({contactEmail:"success",contactPass:""}),localStorage.setItem("id_token",e.token),t.props.history.replace("/")}else alert("No se pudo crear la cuenta")},a.send("email=".concat(this.state.contactEmail,"&password=").concat(this.state.contactPass,"&name=").concat(this.state.contactName,"&lastname=").concat(this.state.contactLastName))}},{key:"render",value:function(){return l.a.createElement("div",{className:"contact",id:"contact"},l.a.createElement("div",{className:"filter"},l.a.createElement("h2",null,"Completa tus datos"),l.a.createElement("form",{className:"form",onSubmit:this._handleSubmit,id:"formContact"},l.a.createElement("label",null,"Nombre:"),l.a.createElement("input",{id:"formName",type:"text",placeholder:"Nombre",name:"formName",value:this.state.contactName,onChange:this._handleChangeName,required:!0}),l.a.createElement("label",null,"Apellido:"),l.a.createElement("input",{id:"formLastName",type:"text",placeholder:"Apellido",name:"formLastName",value:this.state.contactLastName,onChange:this._handleChangeLastName,required:!0}),l.a.createElement("p",null),l.a.createElement("label",null,"Correo Electr\xf3nico:"),l.a.createElement("input",{id:"formEmail",type:"email",placeholder:"Correo electr\xf3nico",name:"formEmail",value:this.state.contactEmail,onChange:this._handleChange,required:!0}),l.a.createElement("label",null,"Contrase\xf1a:"),l.a.createElement("input",{type:"password",placeholder:"Contrase\xf1a",id:"formPass",name:"formPass",value:this.state.contactPass,onChange:this._handleChangePass,required:!0}),l.a.createElement("p",null,l.a.createElement("input",{type:"submit",value:"Crear Cuenta",className:"btn--cta",id:"btn-submit"})))))}}]),t}(n.Component),S=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(s.a)(this,Object(u.a)(t).call(this,e))).state={contactEmail:"",contactPass:""},a._handleSubmit=a._handleSubmit.bind(Object(k.a)(Object(k.a)(a))),a._handleChangeEmail=a._handleChangeEmail.bind(Object(k.a)(Object(k.a)(a))),a._handleChangePass=a._handleChangePass.bind(Object(k.a)(Object(k.a)(a))),a._handlePushSignup=a._handlePushSignup.bind(Object(k.a)(Object(k.a)(a))),a.Auth=new y,a}return Object(h.a)(t,e),Object(i.a)(t,[{key:"_handleChangeEmail",value:function(e){this.setState({contactEmail:e.target.value})}},{key:"_handleChangePass",value:function(e){this.setState({contactPass:e.target.value})}},{key:"_handlePushSignup",value:function(e){this.props.history.push("/signin")}},{key:"_handleSubmit",value:function(e){var t=this;e.preventDefault(),this.Auth.login(this.state.contactEmail,this.state.contactPass).then(function(e){t.props.history.replace("/")}).catch(function(e){alert(e)})}},{key:"render",value:function(){return l.a.createElement("div",{className:"contact",id:"contact"},l.a.createElement("div",{className:"filter"},l.a.createElement("h2",null,"Inicia sesi\xf3n"),l.a.createElement("form",{className:"form",onSubmit:this._handleSubmit,id:"formContact"},l.a.createElement("label",null,"Correo Electr\xf3nico:"),l.a.createElement("input",{id:"formEmail",type:"email",placeholder:"Correo electr\xf3nico",name:"formEmail",value:this.state.contactEmail,onChange:this._handleChangeEmail,required:!0}),l.a.createElement("label",null,"Contrase\xf1a:"),l.a.createElement("input",{type:"password",id:"formPass",placeholder:"Contrase\xf1a",name:"formPass",value:this.state.contactPass,onChange:this._handleChangePass,required:!0}),l.a.createElement("p",null,l.a.createElement("input",{type:"submit",value:"Iniciar Sesi\xf3n",className:"btn--cta",id:"btn-submit"})),l.a.createElement("p",null,l.a.createElement(d.a,{to:"/signup"},"Crea una cuenta")),l.a.createElement("p",null,l.a.createElement(d.a,{to:"/forgotpass"},"Olvid\xe9 mi contrase\xf1a")))))}},{key:"componentWillMount",value:function(){this.Auth.loggedIn()&&this.props.history.replace("/")}}]),t}(n.Component),j=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(s.a)(this,Object(u.a)(t).call(this,e))).state={contactEmail:""},a._handleSubmit=a._handleSubmit.bind(Object(k.a)(Object(k.a)(a))),a._handleChangeEmail=a._handleChangeEmail.bind(Object(k.a)(Object(k.a)(a))),a}return Object(h.a)(t,e),Object(i.a)(t,[{key:"_handleChangeEmail",value:function(e){this.setState({contactEmail:e.target.value})}},{key:"_handleSubmit",value:function(e){e.preventDefault();var t=new XMLHttpRequest;t.open("POST","".concat("https://apptd.herokuapp.com","/auth/forgotPass")),t.setRequestHeader("Content-type","application/x-www-form-urlencoded"),t.onreadystatechange=function(){4===t.readyState&&(201===t.status?alert("Se enviaron los pasos a tu correo para restablecer la contrase\xf1a."):alert("No se pudo enviar el correo."))},t.send("email=".concat(this.state.contactEmail))}},{key:"render",value:function(){return l.a.createElement("div",{className:"contact",id:"contact"},l.a.createElement("div",{className:"filter"},l.a.createElement("h2",null,"Recupera tu contrase\xf1a"),l.a.createElement("form",{className:"form",onSubmit:this._handleSubmit,id:"formContact"},l.a.createElement("label",null,"Correo Electr\xf3nico:"),l.a.createElement("input",{id:"formEmail",type:"email",placeholder:"Correo electr\xf3nico",name:"formEmail",value:this.state.contactEmail,onChange:this._handleChangeEmail,required:!0}),l.a.createElement("p",null,l.a.createElement("input",{type:"submit",value:"Enviar correo",className:"btn--cta",id:"btn-submit"})))))}}]),t}(n.Component),_=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(s.a)(this,Object(u.a)(t).call(this,e))).state={fileName:null,garmentName:"",price:0,size:"",color:"",loaded:0},a._handleChangeFile=a._handleChangeFile.bind(Object(k.a)(Object(k.a)(a))),a._handleChangeGarmentName=a._handleChangeGarmentName.bind(Object(k.a)(Object(k.a)(a))),a._handleChangePrice=a._handleChangePrice.bind(Object(k.a)(Object(k.a)(a))),a._handleChangeSize=a._handleChangeSize.bind(Object(k.a)(Object(k.a)(a))),a._handleChangeColor=a._handleChangeColor.bind(Object(k.a)(Object(k.a)(a))),a._handleUpload=a._handleUpload.bind(Object(k.a)(Object(k.a)(a))),a.uploadFile=a.uploadFile.bind(Object(k.a)(Object(k.a)(a))),a.Auth=new y,a}return Object(h.a)(t,e),Object(i.a)(t,[{key:"_handleChangeFile",value:function(e){this.setState({fileName:e.target.files[0],loaded:0}),console.log(e.target.files[0])}},{key:"_handleChangeGarmentName",value:function(e){this.setState({garmentName:e.target.value})}},{key:"_handleChangePrice",value:function(e){this.setState({price:e.target.value})}},{key:"_handleChangeSize",value:function(e){this.setState({size:e.target.value})}},{key:"_handleChangeColor",value:function(e){this.setState({color:e.target.value})}},{key:"_handleUpload",value:function(e){var t=this,a=new XMLHttpRequest,n=this.state.fileName;a.open("GET","https://apptd.herokuapp.com/sign-s3-single?filename=".concat(n.name,"&filetype=").concat(n.type)),a.setRequestHeader("Authorization","Bearer "+this.getToken()),a.onreadystatechange=function(){if(4===a.readyState)if(200===a.status){var e=JSON.parse(a.responseText);console.log(e),console.log(n),t.uploadFile(n,e.signedRequest,e.url)}else alert("Could not get signed URL.")},a.send()}},{key:"uploadFile",value:function(e,t,a){var n=this,l=new XMLHttpRequest;l.open("PUT",t),l.onreadystatechange=function(){4===l.readyState&&(200===l.status?(document.getElementById("preview").src=a,document.getElementById("avatar-url").value=a,n.uploadItem(e,t,a)):alert("Could not upload file."))},l.send(e)}},{key:"uploadItem",value:function(e,t,a){var n=new XMLHttpRequest;n.open("POST","".concat("https://apptd.herokuapp.com","/items")),n.setRequestHeader("Content-type","application/x-www-form-urlencoded"),n.setRequestHeader("Authorization","Bearer "+this.getToken()),n.onreadystatechange=function(){4===n.readyState&&(201===n.status?alert("Se dio de alta el item."):alert("Could not upload file."))},n.send("color=".concat(this.state.color,"&size=").concat(this.state.size,"&url=").concat(a,"&fileName=").concat(e.name,"&price=").concat(this.state.price,"&garmentName=").concat(this.state.garmentName,"&fileType=").concat(e.type))}},{key:"getToken",value:function(){return localStorage.getItem("id_token")}},{key:"render",value:function(){return l.a.createElement("div",null,l.a.createElement("h2",null,"Cuelga tus prendas en tu closet virtual"),l.a.createElement("br",null),l.a.createElement("input",{type:"text",id:"garment-input",placeholder:"Nombre de la prenda",onChange:this._handleChangeGarmentName}),l.a.createElement("input",{type:"text",id:"price-input",placeholder:"Precio de la prenda",onChange:this._handleChangePrice}),l.a.createElement("br",null),l.a.createElement("input",{type:"text",id:"size-input",placeholder:"Talla de la prenda",onChange:this._handleChangeSize}),l.a.createElement("input",{type:"text",id:"color-input",placeholder:"Color de la prenda",onChange:this._handleChangeColor}),l.a.createElement("br",null),l.a.createElement("input",{type:"file",id:"file-input",onChange:this._handleChangeFile}),l.a.createElement("img",{id:"preview",src:"/images/default.png",alt:""}),l.a.createElement("input",{type:"hidden",id:"avatar-url",name:"avatar-url",value:"/images/default.png"}),l.a.createElement("button",{onClick:this._handleUpload},"Cargar prenda"),l.a.createElement("div",null," ",Math.round(this.state.loaded,2)," %"))}},{key:"componentWillMount",value:function(){this.Auth.loggedIn()||(alert("Favor de iniciar sesi\xf3n con tu usuario"),this.props.history.replace("/signin"))}}]),t}(n.Component),N=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(s.a)(this,Object(u.a)(t).call(this,e))).state={rents:[{}]},a}return Object(h.a)(t,e),Object(i.a)(t,[{key:"handleDownload",value:function(){var e=this,t=new XMLHttpRequest;t.open("GET","https://apptd.herokuapp.com/rents"),t.onreadystatechange=function(){if(4===t.readyState)if(200===t.status){var a=JSON.parse(t.responseText);console.log(a),e.setState({rents:a})}else alert("No se pudieron descargar las rentas")},t.send()}},{key:"render",value:function(){var e=this.state.rents.map(function(e){return l.a.createElement("div",{className:""},l.a.createElement("h2",null,"ID Renta:",e._id),l.a.createElement("br",null),l.a.createElement("h2",null,"ID Item: ",e.item),l.a.createElement("br",null),l.a.createElement("h2",null,"ID User: ",e.user),l.a.createElement("br",null))});return l.a.createElement("div",null,l.a.createElement("h2",null,"Rentas "),l.a.createElement("div",null,e))}},{key:"componentWillMount",value:function(){this.handleDownload()}}]),t}(n.Component),w=function(e){function t(){return Object(c.a)(this,t),Object(s.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){return l.a.createElement("div",null,l.a.createElement("h2",null,"Muchas Gracias por tu compra "),l.a.createElement("p",null,"En breve recibir\xe1s un correo con las indicaciones"),l.a.createElement("br",null),l.a.createElement("br",null),l.a.createElement("p",null,"Gana dinero sin salir de tu casa"),l.a.createElement("p",null,"\xa1Luce siempre diferente!"))}}]),t}(n.Component),P=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(s.a)(this,Object(u.a)(t).call(this,e))).state={},a.Auth=new y,a}return Object(h.a)(t,e),Object(i.a)(t,[{key:"show",value:function(){this.setState({show:!0})}},{key:"close",value:function(){this.setState({show:!1})}},{key:"logout",value:function(){this.Auth.logout()}},{key:"render",value:function(){return l.a.createElement(m.a,null,l.a.createElement("div",null,l.a.createElement(b.a,{show:this.state.show,onClose:this.close.bind(this),transitionSpeed:600},l.a.createElement("div",null,"hey, click outside of me to close me!"),l.a.createElement("a",{style:g.closeStyle,onClick:this.close.bind(this)},"X")),l.a.createElement("h1",null,"The Dresser "),l.a.createElement(d.a,{to:"/Signin"},"Iniciar Sesi\xf3n"),l.a.createElement("br",null),l.a.createElement(d.a,{to:"",onClick:this.logout.bind(this)},"Cerrar Sesi\xf3n"),l.a.createElement("ul",{className:"header"},l.a.createElement("li",null,l.a.createElement(d.a,{to:"/"},"Inicio")),l.a.createElement("li",null,l.a.createElement(d.a,{to:"/signup"},"Crear Cuenta")),l.a.createElement("li",null,l.a.createElement(d.a,{to:"/uploadfiles"},"Carga tus prendas")),l.a.createElement("li",null,l.a.createElement(d.a,{to:"/rents"},"Listado de rentas"))),l.a.createElement("div",{className:"content"},l.a.createElement(p.a,{exact:!0,path:"/",component:C}),l.a.createElement(p.a,{path:"/signup",component:O}),l.a.createElement(p.a,{path:"/signin",component:S}),l.a.createElement(p.a,{path:"/forgotpass",component:j}),l.a.createElement(p.a,{path:"/uploadfiles",component:_}),l.a.createElement(p.a,{path:"/rents",component:N}),l.a.createElement(p.a,{path:"/thanks",component:w}))))}}]),t}(n.Component);a(31);o.a.render(l.a.createElement(P,null),document.getElementById("root"))}},[[19,2,1]]]);
//# sourceMappingURL=main.be4da4f3.chunk.js.map